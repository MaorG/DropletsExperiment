<main>
name, rootDir, global, parameterSpace, load, prep, entities, analysis, output
'microbiotaPaper', 'C:\school\papers\microbiota\', {'pixelSize' 0.16}, {'well' 'time'}, '<load>', '<prep>', '<entities>', '<analysis>', '<output>'


<load>

well,time,BF,GFP,RFP, !RGB, bactChannel, otherChannel, bactThresh, otherThresh, HRFThresh1, cropRect
#'A1', 10, 'tif\long\img_T10_A1_BF.tif', 'tif\long\img_T10_A1_GFP.tif', 'tif\long\img_T10_A1_RFP.tif', 'tif\long\img_T10_A1_RGB.tif', 'RFP', 'GFP', 1500, 500                ,[10000 7000 4000] ,[]
'A1', 16, 'tif\long\img_T16_A1_BF.tif', 'tif\long\img_T16_A1_GFP.tif', 'tif\long\img_T16_A1_RFP.tif', 'tif\long\img_T16_A1_RGB.tif', 'RFP', 'GFP', 1500, 500                ,[10000 7000 4000] ,{}
#'A1', 22, 'tif\long\img_T22_A1_BF.tif', 'tif\long\img_T22_A1_GFP.tif', 'tif\long\img_T22_A1_RFP.tif', 'tif\long\img_T22_A1_RGB.tif', 'RFP', 'GFP', 1500, 500                ,[10000 7000 4000] ,[]
#'A6', 10, 'tif\long\img_T10_A6_BF.tif', 'tif\long\img_T10_A6_GFP.tif', 'tif\long\img_T10_A6_RFP.tif', 'tif\long\img_T10_A6_RGB.tif', 'GFP', 'RFP', 1500, 1000               ,[5000 3500 2000] ,[]
'A6', 16, 'tif\long\img_T16_A6_BF.tif', 'tif\long\img_T16_A6_GFP.tif', 'tif\long\img_T16_A6_RFP.tif', 'tif\long\img_T16_A6_RGB.tif', 'GFP', 'RFP', 1500, 800               ,[5000 3500 2000] ,{}
#'A6', 22, 'tif\long\img_T22_A6_BF.tif', 'tif\long\img_T22_A6_GFP.tif', 'tif\long\img_T22_A6_RFP.tif', 'tif\long\img_T22_A6_RGB.tif', 'GFP', 'RFP', 1000, 1000               ,[5000 3500 2000] ,[]
#'C1', 10, 'tif\long\img_T10_C1_BF.tif', 'tif\long\img_T10_C1_GFP.tif', 'tif\long\img_T10_C1_RFP.tif', 'tif\long\img_T10_C1_RGB.tif', 'RFP', 'GFP', [5000 2000], [1000 800]   ,[5000 3500 2000] ,[]
'C1', 16, 'tif\long\img_T16_C1_BF.tif', 'tif\long\img_T16_C1_GFP.tif', 'tif\long\img_T16_C1_RFP.tif', 'tif\long\img_T16_C1_RGB.tif', 'RFP', 'GFP', [5000 2000], [1000 800]   ,[5000 3500 2000]  ,{}
#'C1', 22, 'tif\long\img_T22_C1_BF.tif', 'tif\long\img_T22_C1_GFP.tif', 'tif\long\img_T22_C1_RFP.tif', 'tif\long\img_T22_C1_RGB.tif', 'RFP', 'GFP', [5000 2000], [1000 800]   ,[5000 3500 2000] ,{'a' 2000 4000 2000 4000}
#'D1', 10, 'tif\long\img_T10_D1_BF.tif', 'tif\long\img_T10_D1_GFP.tif', 'tif\long\img_T10_D1_RFP.tif', 'tif\long\img_T10_D1_RGB.tif', 'GFP', 'RFP', 2000, 1000               ,[5000 3500 2000]  ,{}
'D1', 16, 'tif\long\img_T16_D1_BF.tif', 'tif\long\img_T16_D1_GFP.tif', 'tif\long\img_T16_D1_RFP.tif', 'tif\long\img_T16_D1_RGB.tif', 'GFP', 'RFP', 2000, 1000               ,[5000 3500 2000]  ,{}
#'D1', 22, 'tif\long\img_T22_D1_BF.tif', 'tif\long\img_T22_D1_GFP.tif', 'tif\long\img_T22_D1_RFP.tif', 'tif\long\img_T22_D1_RGB.tif', 'GFP', 'RFP', 2000, 1000               ,[5000 3500 2000]  ,{}
 
<prep>
resName, funcName, parameters
#'BF',  'cropImage', {'src' 'BF'  'borders' 'cropRect'}
#'RFP', 'cropImage', {'src' 'RFP' 'borders' 'cropRect'}
#'GFP', 'cropImage', {'src' 'GFP' 'borders' 'cropRect'}

### Segmentation
#'allMask', 'segmentObjectsHRF', {'src' 'BF' 'RGBsrc' 'RGB'  'verbose' 1 'HRFThresh' 'HRFThresh1'}

### c#lassification bacteria
'bactMask', 'classifyByFluorescenseTemp2', {'originalMask' 'allMask' 'RGBsrc' 'BF' 'verbose' 0}
'bactMaskDilated', 'morphOp', {'src' 'bactMask' 'op' 'dilate' 'dist' 1}
'nonBactMask', 'booleanOp', {'src1' 'allMask' 'src2' 'bactMaskDilated' 'op' 'difference'}
'nonBactMask', 'morphOp', {'src' 'nonBactMask' 'op' 'areaOpen' 'dist' 0.5}
'nonBactMask', 'morphOp', {'src' 'nonBactMask' 'op' 'close' 'dist' 0.4}
'nonBactMask', 'booleanOp', {'src1' 'allMask' 'src2' 'bactMaskDilated' 'op' 'difference'}
'bactMask', 'morphOp', {'src' 'bactMask' 'op' 'areaOpen' 'dist' 0.5}

'nonBactMask', 'morphOp', {'src' 'nonBactMask' 'op' 'areaOpen' 'dist' 0.5}
'nonBactMask', 'morphOp', {'src' 'nonBactMask' 'op' 'close' 'dist' 1}
'nonBactMask', 'morphOp', {'src' 'nonBactMask' 'op' 'open' 'dist' 0.4}

'', 'ExportFields', {'Fields' {'@allMask' '@bactMask' '@nonBactMask'} 'targetDir' 'revision\manualInput_v2\' 'updatedLoad' 'revision\manualInput_v2\loadMasks.csv'} 



<ignore>
#
#'microbiotaMask', 'morphOp', {'src' 'microbiotaMask' 'op' 'areaOpen' 'dist' 0.5}
#'bactMask', 'morphOp', {'src' 'bactMask' 'op' 'areaOpen' 'dist' 0.5}
#'bactMask', 'morphOp', {'src' 'bactMask' 'op' 'close' 'dist' 1}

### classification plant parts
'plantRFPMask', 'thresholdByValue', {'src' 'otherChannel' 'threshold'  800}
'plantRFPMask', 'booleanOp', {'src1' 'allMask' 'src2' 'plantRFPMask' 'op' 'intersect'}
'plantRFPMask', 'morphOp', {'src' 'plantRFPMask' 'op' 'areaOpen' 'dist' 10}

'plantRFPMask_large', 'morphOp', {'src' 'plantRFPMask' 'op' 'areaOpen' 'dist' 200}
#'plantRFPMask', 'booleanOp', {'src1' 'plantRFPMask' 'src2' 'plantRFPMask_large' 'op' 'difference'}


'plantRFPMask_dilated', 'morphOp', {'src' 'plantRFPMask' 'op' 'dilate' 'dist' 2}

'microbiotaMask_minus_plant',  'booleanOp', {'src1' 'microbiotaMask' 'src2' 'plantRFPMask_dilated' 'op' 'difference'}


'microbiotaMask_no_plant', 'removeOverlappingRegions',  {'src1' 'microbiotaMask' 'src2' 'plantRFPMask_dilated' 'maxSizeToRemove' inf}

'plantRFPMask_v2', 'booleanOp', {'src1' 'plantRFPMask' 'src2' 'bactMaskDilated' 'op' 'difference'}
#'microbiotaMask_no_plant', 'booleanOp', {'src1' 'microbiotaMask' 'src2' 'plantRFPMask_dilated' 'op' 'difference'}


### removing cells that moved between BF and flourescence imaging
#'fluoMask', 'thresholdByValue', {'src' 'bactChannel' 'threshold'  800}
#'fluoMask', 'thresholdByValue', {'src' 'bactChannel' 'threshold'  1200}
#'allMaskDilated','morphOp', {'src' 'allMask' 'op' 'dilate' 'dist' 1}
#'fluoMask', 'booleanOp', {'src1' 'fluoMask' 'src2' 'allMaskDilated' 'op' 'difference'}
#'fluoMask', 'morphOp', {'src' 'fluoMask' 'op' 'dilate' 'dist' 2}
#'bactMaskFixed', 'removeOverlappingRegions',  {'src1' 'bactMask' 'src2' 'fluoMask' 'maxSizeToRemove' inf}
#'bactMaskError', 'booleanOp',  {'src1' 'bactMask' 'src2' 'bactMaskFixed' 'op' 'difference'}


### analysis
#'NN0microplant', 'getNN', {'dynamic' 'bactMask' 'static' 'microbiotaMask' 'mode' 'edge' 'staticOverlap' 1 'repeats' 100 'confidence' 0.01  'verbose' 0}
#'NN0micro', 'getNN', {'dynamic' 'bactMask' 'static' 'microbiotaMask_no_plant' 'mode' 'edge' 'staticOverlap' 1 'repeats' 100 'confidence' 0.01  'verbose' 0}
#'NN0plant', 'getNN', {'dynamic' 'bactMask' 'static' 'plantRFPMask' 'mode' 'edge' 'staticOverlap' 1 'repeats' 100 'confidence' 0.01  'verbose' 0}
#'NN0plant_v2', 'getNN', {'dynamic' 'bactMask' 'static' 'plantRFPMask_v2' 'mode' 'edge' 'staticOverlap' 1 'repeats' 100 'confidence' 0.01  'verbose' 0}

'NN0plant2micro', 'getNN', {'dynamic' 'plantRFPMask_v2' 'static' 'microbiotaMask_minus_plant' 'mode' 'edge' 'staticOverlap' 1 'repeats' 100 'confidence' 0.01  'verbose' 0}


#'pc1', 'getTwoPointCorr', {'src' 'bactMask' 'dr' 12 'repeats' 10}
#'pc2', 'getTwoPointCorr', {'src' 'bactMask' 'dr' 24 'repeats' 10}

#'pc_r', 'getTwoPointCorrMG', {'src' 'bactMask' 'random' 'CSR' 'dr' 4 'repeats' 100}
#'pc_s', 'getTwoPointCorrMG', {'src' 'bactMask' 'random' 'shuffle' 'dr' 4 'repeats' 100}

#'pc_r_2', 'getTwoPointCorrMG', {'src' 'bactMask' 'random' 'CSR' 'dr' 2 'repeats' 100}
#'pc_s_2', 'getTwoPointCorrMG', {'src' 'bactMask' 'random' 'shuffle' 'dr' 2 'repeats' 100}
#'pc_r_4', 'getTwoPointCorrMG', {'src' 'bactMask' 'random' 'CSR' 'dr' 4 'repeats' 100}
#'pc_s_4', 'getTwoPointCorrMG', {'src' 'bactMask' 'random' 'shuffle' 'dr' 4 'repeats' 100}


##'', 'ExportFields', {'Fields' {'@BF' '@GFP' '@RFP'} 'targetDir' 'tif\select' 'updatedLoad' 'load_fig8.csv'} 

<entities>
targetName, resName, funcName, parameters
'bacteria', '', 'createEntitiesFromSeg', {'seg' 'bactMask' 'properties' {'Area' 'pixelIdxList' 'Centroid'} }
'bacteria', 'area', 'resFromRegions', {'regionProp' 'Area'}


<analysis>
resName, funcName, entities, parameters
'bacteriaSizeDistribution', 'aggrSizeDistribution', 'bacteria', {'aggrArea' 'area' 'bins_min' 0 'bins_max' 5 'bins_step' 0.1}

<output>
stage, funcName, srcName, filter, hold, parameters

'data', 'displayRGBBF', '', {}, {}, {'R' 'bactMask' 'Rscale' [0 1] 'G' '' 'Gscale' [0 1] 'B' 'nonBactMask' 'Bscale' [0 1] 'BG' 'BF'}
#'data', 'displayRGBBF', '', {}, {}, {'R' 'bactMask' 'Rscale' [0 1] 'G' 'plantRFPMask' 'Gscale' [0 1] 'B' 'microbiotaMask_no_plant' 'Bscale' [0 1] 'BG' 'BF'}

#'data', 'showNN', 'NN0microplant' , {}, {}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}
#'data', 'showNN', 'NN0micro' , {}, {}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}
#'data', 'showNN', 'NN0plant' , {}, {}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}
#'data', 'showNN', 'NN0plant_v2' , {}, {}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}
#'data', 'showNN', 'NN0plant2micro' , {}, {}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}

#'data', 'showNN', 'NN1' , {'well' {'A6'}}, {}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}
#'data', 'showNN', 'NN1' , {'time' {10 16 22 26}}, {}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}
#'data', 'showNN', 'NN0' , {},{}, {'mode' 'notbins' 'cumulative' 1 'confidence' 0.01}
#'data', 'showNN', 'NN0' , {'time' {16}}, {'time'}, {'mode' 'notbins' 'cumulative' 1  'confidence' 0.01}

#'data', 'showTwoPointCorr', 'pc_r', {}, {}, {}
#'data', 'showTwoPointCorr', 'pc_r', {'well' {'A4' 'D2'} 'time' {16}}, {}, {}
#'data', 'showTwoPointCorr', 'pc_s', {'well' {'A4' 'D2'} 'time' {16}}, {}, {}

#'data', 'showTwoPointCorr', 'pc_r', {'time' {16}}, {}, {}
#'data', 'showTwoPointCorr', 'pc_s', {'time' {16}}, {}, {}
#'data', 'showTwoPointCorrDouble', '', {'time' {16}}, {}, {}


#'data', 'showTwoPointCorrDouble', '', {}, {}, {'CSRname' 'pc_r_2' 'SFLname' 'pc_s_2'}
'data', 'showTwoPointCorrDouble', '', {}, {}, {'CSRname' 'pc_r_4' 'SFLname' 'pc_s_4'}
#'data', 'showTwoPointCorrDouble', '', {'time' {16}}, {}, {'CSRname' 'pc_r' 'SFLname' 'pc_s'}
